services:
  phntm_bridge:
    image: ghcr.io/phantomcybernetics/phntm_bridge_client:main-humble
    container_name: phntm-bridge
    hostname: phntm-bridge.local
    restart: unless-stopped
    privileged: true
    network_mode: host
    ipc: host
    volumes:
      - ./phntm_bridge.yaml:/ros2_ws/phntm_bridge_params.yaml
      - ./phntm_bridge.yaml:/ros2_ws/phntm_agent_params.yaml
      - /var/run:/host_run
      - /tmp:/tmp
    devices:
      - /dev:/dev
    command: ros2 launch phntm_bridge client_agent_launch.py

  # Chat widgets HTTPS server
  chat_widgets_server:
    image: node:18-alpine
    container_name: chat-widgets-server
    restart: unless-stopped
    network_mode: host
    volumes:
      - ./ui_extras:/app
    working_dir: /app
    command: sh -c "npm install && node server.js"
